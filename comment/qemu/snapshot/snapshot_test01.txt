

(qemu) Formatting '/tmp/overlay01.qcow2', fmt=qcow2 cluster_size=65536 extended_l2=off compression_type=zlib size=1073741824 backing_file=test01.qcow2 backing_fmt=qcow2 lazy_refcounts=off refcount_bits=16
[New Thread 0x7fffeeef2700 (LWP 30297)]

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2b78, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2b78, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x5555578ddc80, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=10, shared_perm=15, opaque=0x555557158250, child=0x7ffd3ebf2c98, tran=0x555557347940, errp=0x7ffd3ebf2f38) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x5555578ddc80, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=10, shared_perm=15, opaque=0x555557158250, errp=0x7ffd3ebf2f38)
    at ../block.c:3159
#3  0x0000555555d912af in blk_insert_bs (blk=0x555557158250, bs=0x5555578ddc80, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:907
#4  0x0000555555d90155 in blk_new_with_bs (bs=0x5555578ddc80, perm=10, shared_perm=15, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:399
#5  0x0000555555dda4e7 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3618
#6  0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#7  0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#8  0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#9  0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#10 0x00007fffffffcd60 in  ()
#11 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2ca8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2ca8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7ffd3ebf2ca8) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557573e70) at ../block.c:3230
#3  0x0000555555d91217 in blk_remove_bs (blk=0x555557158250) at ../block/block-backend.c:896
#4  0x0000555555d9038b in blk_delete (blk=0x555557158250) at ../block/block-backend.c:480
#5  0x0000555555d906ab in blk_unref (blk=0x555557158250) at ../block/block-backend.c:538
#6  0x0000555555dda919 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3687
#7  0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#8  0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#9  0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#10 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#11 0x00007fffffffcd60 in  ()
#12 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf29b8, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf29b8, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x5555578ddc80, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=0, shared_perm=15, opaque=0x5555578e1f70, child=0x7ffd3ebf2ad8, tran=0x555557573ea0, errp=0x7ffd3ebf2bb0) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x5555578ddc80, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=0, shared_perm=15, opaque=0x5555578e1f70, errp=0x7ffd3ebf2bb0)
    at ../block.c:3159
#3  0x0000555555d912af in blk_insert_bs (blk=0x5555578e1f70, bs=0x5555578ddc80, errp=0x7ffd3ebf2bb0) at ../block/block-backend.c:907
#4  0x0000555555d6ab2d in bdrv_open_inherit (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=8710, parent=0x0, child_class=0x0, child_role=0, errp=0x7ffd3ebf2f38) at ../block.c:3950
#5  0x0000555555d6b275 in bdrv_open (filename=0x0, reference=0x0, options=0x55555762a6a0, flags=518, errp=0x7ffd3ebf2f38) at ../block.c:4087
#6  0x0000555555d90243 in blk_new_open (filename=0x0, reference=0x0, options=0x55555762a6a0, flags=518, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:454
#7  0x0000555555dda9c7 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3701
#8  0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#9  0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#10 0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#11 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#12 0x00007fffffffcd60 in  ()
#13 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf27a8, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf27a8, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x5555578ddc80, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, perm=11, shared_perm=5, opaque=0x555556b08d20, child=0x7ffd3ebf2938, tran=0x5555578e22c0, errp=0x7ffd3ebf2aa0) at ../block.c:3055
#2  0x0000555555d68e14 in bdrv_attach_child_noperm
    (parent_bs=0x555556b08d20, child_bs=0x5555578ddc80, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, child=0x7ffd3ebf2938, tran=0x5555578e22c0, errp=0x7ffd3ebf2aa0) at ../block.c:3103
#3  0x0000555555d6909d in bdrv_attach_child
    (parent_bs=0x555556b08d20, child_bs=0x5555578ddc80, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, errp=0x7ffd3ebf2aa0) at ../block.c:3201
#4  0x0000555555d69fa5 in bdrv_open_child
    (filename=0x0, options=0x5555576d0fb0, bdref_key=0x5555560e8f9c "file", parent=0x555556b08d20, child_class=0x555556402ba0 <child_of_bds>, child_role=19, allow_none=false, errp=0x7ffd3ebf2aa0)
    at ../block.c:3667
#5  0x0000555555dd6700 in qcow2_open (bs=0x555556b08d20, options=0x5555576d0fb0, flags=8710, errp=0x7ffd3ebf2aa0) at ../block/qcow2.c:1897
#6  0x0000555555d65bf1 in bdrv_open_driver (bs=0x555556b08d20, drv=0x555556783080 <bdrv_qcow2>, node_name=0x0, options=0x5555576d0fb0, open_flags=8710, errp=0x7ffd3ebf2bb0) at ../block.c:1627
#7  0x0000555555d66643 in bdrv_open_common (bs=0x555556b08d20, file=0x5555578e1f70, options=0x5555576d0fb0, errp=0x7ffd3ebf2bb0) at ../block.c:1923
#8  0x0000555555d6ad0d in bdrv_open_inherit (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=8710, parent=0x0, child_class=0x0, child_role=0, errp=0x7ffd3ebf2f38) at ../block.c:3992
#9  0x0000555555d6b275 in bdrv_open (filename=0x0, reference=0x0, options=0x55555762a6a0, flags=518, errp=0x7ffd3ebf2f38) at ../block.c:4087
#10 0x0000555555d90243 in blk_new_open (filename=0x0, reference=0x0, options=0x55555762a6a0, flags=518, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:454
#11 0x0000555555dda9c7 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3701
#12 0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#13 0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#14 0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#15 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#16 0x00007fffffffcd60 in  ()
#17 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2aa8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2aa8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7ffd3ebf2aa8) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557619c10) at ../block.c:3230
#3  0x0000555555d91217 in blk_remove_bs (blk=0x5555578e1f70) at ../block/block-backend.c:896
#4  0x0000555555d9038b in blk_delete (blk=0x5555578e1f70) at ../block/block-backend.c:480
#5  0x0000555555d906ab in blk_unref (blk=0x5555578e1f70) at ../block/block-backend.c:538
#6  0x0000555555d6ad39 in bdrv_open_inherit (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=8710, parent=0x0, child_class=0x0, child_role=0, errp=0x7ffd3ebf2f38) at ../block.c:3998
#7  0x0000555555d6b275 in bdrv_open (filename=0x0, reference=0x0, options=0x55555762a6a0, flags=518, errp=0x7ffd3ebf2f38) at ../block.c:4087
#8  0x0000555555d90243 in blk_new_open (filename=0x0, reference=0x0, options=0x55555762a6a0, flags=518, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:454
#9  0x0000555555dda9c7 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3701
#10 0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#11 0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#12 0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#13 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#14 0x00007fffffffcd60 in  ()
#15 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2b98, new_bs=0x555556b08d20, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2b98, new_bs=0x555556b08d20, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x555556b08d20, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=11, shared_perm=15, opaque=0x555557158250, child=0x7ffd3ebf2cb8, tran=0x555557619c80, errp=0x7ffd3ebf2f38) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x555556b08d20, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=11, shared_perm=15, opaque=0x555557158250, errp=0x7ffd3ebf2f38)
    at ../block.c:3159
#3  0x0000555555d90294 in blk_new_open (filename=0x0, reference=0x0, options=0x55555762a6a0, flags=518, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:460
#4  0x0000555555dda9c7 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3701
#5  0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#6  0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#7  0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#8  0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#9  0x00007fffffffcd60 in  ()
#10 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2ca8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2ca8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7ffd3ebf2ca8) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557497140) at ../block.c:3230
#3  0x0000555555d91217 in blk_remove_bs (blk=0x555557158250) at ../block/block-backend.c:896
#4  0x0000555555d9038b in blk_delete (blk=0x555557158250) at ../block/block-backend.c:480
#5  0x0000555555d906ab in blk_unref (blk=0x555557158250) at ../block/block-backend.c:538
#6  0x0000555555ddace3 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3767
#7  0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#8  0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#9  0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#10 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#11 0x00007fffffffcd60 in  ()
#12 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2ba8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2ba8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7ffd3ebf2ba8) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x5555574970c0) at ../block.c:3230
#3  0x0000555555d6935f in bdrv_unref_child (parent=0x555556b08d20, child=0x5555574970c0) at ../block.c:3309
#4  0x0000555555d6d2f6 in bdrv_close (bs=0x555556b08d20) at ../block.c:4940
#5  0x0000555555d6e32a in bdrv_delete (bs=0x555556b08d20) at ../block.c:5404
#6  0x0000555555d71187 in bdrv_unref (bs=0x555556b08d20) at ../block.c:6919
#7  0x0000555555d6918e in bdrv_root_unref_child (child=0x0) at ../block.c:3231
#8  0x0000555555d91217 in blk_remove_bs (blk=0x555557158250) at ../block/block-backend.c:896
#9  0x0000555555d9038b in blk_delete (blk=0x555557158250) at ../block/block-backend.c:480
#10 0x0000555555d906ab in blk_unref (blk=0x555557158250) at ../block/block-backend.c:538
#11 0x0000555555ddace3 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3767
#12 0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#13 0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#14 0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#15 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#16 0x00007fffffffcd60 in  ()
#17 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf29b8, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf29b8, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x5555578ddc80, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=0, shared_perm=15, opaque=0x5555578e1f70, child=0x7ffd3ebf2ad8, tran=0x555557619c40, errp=0x7ffd3ebf2bb0) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x5555578ddc80, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=0, shared_perm=15, opaque=0x5555578e1f70, errp=0x7ffd3ebf2bb0)
    at ../block.c:3159
#3  0x0000555555d912af in blk_insert_bs (blk=0x5555578e1f70, bs=0x5555578ddc80, errp=0x7ffd3ebf2bb0) at ../block/block-backend.c:907
#4  0x0000555555d6ab2d in bdrv_open_inherit (filename=0x0, reference=0x0, options=0x55555762b6c0, flags=73986, parent=0x0, child_class=0x0, child_role=0, errp=0x7ffd3ebf2f38) at ../block.c:3950
#5  0x0000555555d6b275 in bdrv_open (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=65794, errp=0x7ffd3ebf2f38) at ../block.c:4087
#6  0x0000555555d90243 in blk_new_open (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=65794, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:454
#7  0x0000555555ddad91 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3782
#8  0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#9  0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#10 0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#11 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#12 0x00007fffffffcd60 in  ()
#13 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf27a8, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf27a8, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x5555578ddc80, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, perm=10, shared_perm=5, opaque=0x555556b08d20, child=0x7ffd3ebf2938, tran=0x5555578e22c0, errp=0x7ffd3ebf2aa0) at ../block.c:3055
#2  0x0000555555d68e14 in bdrv_attach_child_noperm
    (parent_bs=0x555556b08d20, child_bs=0x5555578ddc80, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, child=0x7ffd3ebf2938, tran=0x5555578e22c0, errp=0x7ffd3ebf2aa0) at ../block.c:3103
#3  0x0000555555d6909d in bdrv_attach_child
    (parent_bs=0x555556b08d20, child_bs=0x5555578ddc80, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, errp=0x7ffd3ebf2aa0) at ../block.c:3201
#4  0x0000555555d69fa5 in bdrv_open_child
    (filename=0x0, options=0x55555762b6c0, bdref_key=0x5555560e8f9c "file", parent=0x555556b08d20, child_class=0x555556402ba0 <child_of_bds>, child_role=19, allow_none=false, errp=0x7ffd3ebf2aa0)
    at ../block.c:3667
#5  0x0000555555dd6700 in qcow2_open (bs=0x555556b08d20, options=0x55555762b6c0, flags=73730, errp=0x7ffd3ebf2aa0) at ../block/qcow2.c:1897
#6  0x0000555555d65bf1 in bdrv_open_driver (bs=0x555556b08d20, drv=0x555556783080 <bdrv_qcow2>, node_name=0x0, options=0x55555762b6c0, open_flags=73730, errp=0x7ffd3ebf2bb0) at ../block.c:1627
#7  0x0000555555d66643 in bdrv_open_common (bs=0x555556b08d20, file=0x5555578e1f70, options=0x55555762b6c0, errp=0x7ffd3ebf2bb0) at ../block.c:1923
#8  0x0000555555d6ad0d in bdrv_open_inherit (filename=0x0, reference=0x0, options=0x55555762b6c0, flags=73986, parent=0x0, child_class=0x0, child_role=0, errp=0x7ffd3ebf2f38) at ../block.c:3992
#9  0x0000555555d6b275 in bdrv_open (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=65794, errp=0x7ffd3ebf2f38) at ../block.c:4087
#10 0x0000555555d90243 in blk_new_open (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=65794, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:454
#11 0x0000555555ddad91 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3782
#12 0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#13 0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#14 0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#15 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#16 0x00007fffffffcd60 in  ()
#17 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2aa8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2aa8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7ffd3ebf2aa8) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557619c60) at ../block.c:3230
#3  0x0000555555d91217 in blk_remove_bs (blk=0x5555578e1f70) at ../block/block-backend.c:896
#4  0x0000555555d9038b in blk_delete (blk=0x5555578e1f70) at ../block/block-backend.c:480
#5  0x0000555555d906ab in blk_unref (blk=0x5555578e1f70) at ../block/block-backend.c:538
#6  0x0000555555d6ad39 in bdrv_open_inherit (filename=0x0, reference=0x0, options=0x55555762b6c0, flags=73986, parent=0x0, child_class=0x0, child_role=0, errp=0x7ffd3ebf2f38) at ../block.c:3998
#7  0x0000555555d6b275 in bdrv_open (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=65794, errp=0x7ffd3ebf2f38) at ../block.c:4087
#8  0x0000555555d90243 in blk_new_open (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=65794, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:454
#9  0x0000555555ddad91 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3782
#10 0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#11 0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#12 0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#13 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#14 0x00007fffffffcd60 in  ()
#15 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2b98, new_bs=0x555556b08d20, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2b98, new_bs=0x555556b08d20, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x555556b08d20, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=0, shared_perm=15, opaque=0x555557158250, child=0x7ffd3ebf2cb8, tran=0x555557619cd0, errp=0x7ffd3ebf2f38) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x555556b08d20, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=0, shared_perm=15, opaque=0x555557158250, errp=0x7ffd3ebf2f38)
    at ../block.c:3159
#3  0x0000555555d90294 in blk_new_open (filename=0x0, reference=0x0, options=0x5555576d0fb0, flags=65794, errp=0x7ffd3ebf2f38) at ../block/block-backend.c:460
#4  0x0000555555ddad91 in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3782
#5  0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#6  0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#7  0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#8  0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#9  0x00007fffffffcd60 in  ()
#10 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2ca8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2ca8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7ffd3ebf2ca8) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557619c60) at ../block.c:3230
#3  0x0000555555d91217 in blk_remove_bs (blk=0x555557158250) at ../block/block-backend.c:896
#4  0x0000555555d9038b in blk_delete (blk=0x555557158250) at ../block/block-backend.c:480
#5  0x0000555555d906ab in blk_unref (blk=0x555557158250) at ../block/block-backend.c:538
#6  0x0000555555ddadca in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3792
#7  0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#8  0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#9  0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#10 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#11 0x00007fffffffcd60 in  ()
#12 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7ffd3ebf2ba8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7ffd3ebf2ba8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7ffd3ebf2ba8) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557573e60) at ../block.c:3230
#3  0x0000555555d6935f in bdrv_unref_child (parent=0x555556b08d20, child=0x555557573e60) at ../block.c:3309
#4  0x0000555555d6d2f6 in bdrv_close (bs=0x555556b08d20) at ../block.c:4940
#5  0x0000555555d6e32a in bdrv_delete (bs=0x555556b08d20) at ../block.c:5404
#6  0x0000555555d71187 in bdrv_unref (bs=0x555556b08d20) at ../block.c:6919
#7  0x0000555555d6918e in bdrv_root_unref_child (child=0x0) at ../block.c:3231
#8  0x0000555555d91217 in blk_remove_bs (blk=0x555557158250) at ../block/block-backend.c:896
#9  0x0000555555d9038b in blk_delete (blk=0x555557158250) at ../block/block-backend.c:480
#10 0x0000555555d906ab in blk_unref (blk=0x555557158250) at ../block/block-backend.c:538
#11 0x0000555555ddadca in qcow2_co_create (create_options=0x555557532c10, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3792
#12 0x0000555555ddb1c9 in qcow2_co_create_opts (drv=0x555556783080 <bdrv_qcow2>, filename=0x555556a72780 "/tmp/overlay01.qcow2", opts=0x5555571581e0, errp=0x7ffd3ebf2f38) at ../block/qcow2.c:3916
#13 0x0000555555d63673 in bdrv_create_co_entry (opaque=0x7fffffffd540) at ../block.c:534
#14 0x0000555555f09ab8 in coroutine_trampoline (i0=1466004512, i1=21845) at ../util/coroutine-ucontext.c:177
#15 0x00007ffff5043190 in __start_context () at /lib64/libc.so.6
#16 0x00007fffffffcd60 in  ()
#17 0x0000000000000000 in  ()
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd328, new_bs=0x555556b08d20, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd328, new_bs=0x555556b08d20, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x555556b08d20, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=0, shared_perm=15, opaque=0x555557363a80, child=0x7fffffffd448, tran=0x5555573479e0, errp=0x7fffffffd520) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x555556b08d20, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=0, shared_perm=15, opaque=0x555557363a80, errp=0x7fffffffd520)
    at ../block.c:3159
#3  0x0000555555d912af in blk_insert_bs (blk=0x555557363a80, bs=0x555556b08d20, errp=0x7fffffffd520) at ../block/block-backend.c:907
#4  0x0000555555d6ab2d in bdrv_open_inherit
    (filename=0x5555571580f0 "/tmp/overlay01.qcow2", reference=0x0, options=0x555557351c00, flags=8482, parent=0x0, child_class=0x0, child_role=0, errp=0x7fffffffd758) at ../block.c:3950
#5  0x0000555555d6b275 in bdrv_open (filename=0x5555571580f0 "/tmp/overlay01.qcow2", reference=0x0, options=0x555557779000, flags=8482, errp=0x7fffffffd758) at ../block.c:4087
#6  0x0000555555d57e6a in external_snapshot_prepare (common=0x5555573287d0, errp=0x7fffffffd758) at ../blockdev.c:1535
#7  0x0000555555d5985b in qmp_transaction (dev_list=0x7fffffffd7d0, has_props=false, props=0x5555571581c0, errp=0x7fffffffd928) at ../blockdev.c:2358
#8  0x0000555555d56c56 in blockdev_do_action (action=0x7fffffffd850, errp=0x7fffffffd928) at ../blockdev.c:1042
#9  0x0000555555d56d72 in qmp_blockdev_snapshot_sync
    (has_device=false, device=0x0, has_node_name=true, node_name=0x5555572b1b90 "drive01", snapshot_file=0x5555571580f0 "/tmp/overlay01.qcow2", has_snapshot_node_name=true, snapshot_node_name=0x555557158230 "over01", has_format=false, format=0x0, has_mode=false, mode=NEW_IMAGE_MODE_EXISTING, errp=0x7fffffffd928) at ../blockdev.c:1070
#10 0x0000555555e69455 in qmp_marshal_blockdev_snapshot_sync (args=0x7fffe0003910, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:280
#11 0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#12 0x0000555555f06dc7 in aio_bh_call (bh=0x55555716a280) at ../util/async.c:150
#13 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#14 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#15 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#16 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#17 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#18 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#19 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#20 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#21 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#22 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.
[Thread 0x7fffeeef2700 (LWP 30297) exited]

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd118, new_bs=0x555556b08d20, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd118, new_bs=0x555556b08d20, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x555556b08d20, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, perm=11, shared_perm=5, opaque=0x5555578ddc80, child=0x7fffffffd2a8, tran=0x555557158140, errp=0x7fffffffd410) at ../block.c:3055
#2  0x0000555555d68e14 in bdrv_attach_child_noperm
    (parent_bs=0x5555578ddc80, child_bs=0x555556b08d20, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, child=0x7fffffffd2a8, tran=0x555557158140, errp=0x7fffffffd410) at ../block.c:3103
#3  0x0000555555d6909d in bdrv_attach_child
    (parent_bs=0x5555578ddc80, child_bs=0x555556b08d20, child_name=0x5555560e8f9c "file", child_class=0x555556402ba0 <child_of_bds>, child_role=19, errp=0x7fffffffd410) at ../block.c:3201
#4  0x0000555555d69fa5 in bdrv_open_child
    (filename=0x0, options=0x555557351c00, bdref_key=0x5555560e8f9c "file", parent=0x5555578ddc80, child_class=0x555556402ba0 <child_of_bds>, child_role=19, allow_none=false, errp=0x7fffffffd410)
    at ../block.c:3667
#5  0x0000555555dd6700 in qcow2_open (bs=0x5555578ddc80, options=0x555557351c00, flags=8226, errp=0x7fffffffd410) at ../block/qcow2.c:1897
#6  0x0000555555d65bf1 in bdrv_open_driver (bs=0x5555578ddc80, drv=0x555556783080 <bdrv_qcow2>, node_name=0x5555574170e0 "over01", options=0x555557351c00, open_flags=8226, errp=0x7fffffffd520)
    at ../block.c:1627
#7  0x0000555555d66643 in bdrv_open_common (bs=0x5555578ddc80, file=0x555557363a80, options=0x555557351c00, errp=0x7fffffffd520) at ../block.c:1923
#8  0x0000555555d6ad0d in bdrv_open_inherit
    (filename=0x5555571580f0 "/tmp/overlay01.qcow2", reference=0x0, options=0x555557351c00, flags=8482, parent=0x0, child_class=0x0, child_role=0, errp=0x7fffffffd758) at ../block.c:3992
#9  0x0000555555d6b275 in bdrv_open (filename=0x5555571580f0 "/tmp/overlay01.qcow2", reference=0x0, options=0x555557779000, flags=8482, errp=0x7fffffffd758) at ../block.c:4087
#10 0x0000555555d57e6a in external_snapshot_prepare (common=0x5555573287d0, errp=0x7fffffffd758) at ../blockdev.c:1535
#11 0x0000555555d5985b in qmp_transaction (dev_list=0x7fffffffd7d0, has_props=false, props=0x5555571581c0, errp=0x7fffffffd928) at ../blockdev.c:2358
#12 0x0000555555d56c56 in blockdev_do_action (action=0x7fffffffd850, errp=0x7fffffffd928) at ../blockdev.c:1042
#13 0x0000555555d56d72 in qmp_blockdev_snapshot_sync
    (has_device=false, device=0x0, has_node_name=true, node_name=0x5555572b1b90 "drive01", snapshot_file=0x5555571580f0 "/tmp/overlay01.qcow2", has_snapshot_node_name=true, snapshot_node_name=0x555557158230 "over01", has_format=false, format=0x0, has_mode=false, mode=NEW_IMAGE_MODE_EXISTING, errp=0x7fffffffd928) at ../blockdev.c:1070
#14 0x0000555555e69455 in qmp_marshal_blockdev_snapshot_sync (args=0x7fffe0003910, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:280
#15 0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#16 0x0000555555f06dc7 in aio_bh_call (bh=0x55555716a280) at ../util/async.c:150
#17 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#18 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#19 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#20 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#21 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#22 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#23 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#24 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#25 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#26 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.
[New Thread 0x7fffeeef2700 (LWP 30306)]

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd418, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd418, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7fffffffd418) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557347940) at ../block.c:3230
#3  0x0000555555d91217 in blk_remove_bs (blk=0x555557363a80) at ../block/block-backend.c:896
#4  0x0000555555d9038b in blk_delete (blk=0x555557363a80) at ../block/block-backend.c:480
#5  0x0000555555d906ab in blk_unref (blk=0x555557363a80) at ../block/block-backend.c:538
#6  0x0000555555d6ad39 in bdrv_open_inherit
    (filename=0x5555571580f0 "/tmp/overlay01.qcow2", reference=0x0, options=0x555557351c00, flags=8482, parent=0x0, child_class=0x0, child_role=0, errp=0x7fffffffd758) at ../block.c:3998
#7  0x0000555555d6b275 in bdrv_open (filename=0x5555571580f0 "/tmp/overlay01.qcow2", reference=0x0, options=0x555557779000, flags=8482, errp=0x7fffffffd758) at ../block.c:4087
#8  0x0000555555d57e6a in external_snapshot_prepare (common=0x5555573287d0, errp=0x7fffffffd758) at ../blockdev.c:1535
#9  0x0000555555d5985b in qmp_transaction (dev_list=0x7fffffffd7d0, has_props=false, props=0x5555571581c0, errp=0x7fffffffd928) at ../blockdev.c:2358
#10 0x0000555555d56c56 in blockdev_do_action (action=0x7fffffffd850, errp=0x7fffffffd928) at ../blockdev.c:1042
#11 0x0000555555d56d72 in qmp_blockdev_snapshot_sync
    (has_device=false, device=0x0, has_node_name=true, node_name=0x5555572b1b90 "drive01", snapshot_file=0x5555571580f0 "/tmp/overlay01.qcow2", has_snapshot_node_name=true, snapshot_node_name=0x555557158230 "over01", has_format=false, format=0x0, has_mode=false, mode=NEW_IMAGE_MODE_EXISTING, errp=0x7fffffffd928) at ../blockdev.c:1070
#12 0x0000555555e69455 in qmp_marshal_blockdev_snapshot_sync (args=0x7fffe0003910, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:280
#13 0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#14 0x0000555555f06dc7 in aio_bh_call (bh=0x55555716a280) at ../util/async.c:150
#15 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#16 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#17 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#18 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#19 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#20 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#21 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#22 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#23 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#24 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd4b8, new_bs=0x555556a7ae40, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd4b8, new_bs=0x555556a7ae40, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x555556a7ae40, child_name=0x5555560d0670 "backing", child_class=0x555556402ba0 <child_of_bds>, child_role=8, perm=0, shared_perm=15, opaque=0x5555578ddc80, child=0x5555578e1cd0, tran=0x555557363dd0, errp=0x7fffffffd758) at ../block.c:3055
#2  0x0000555555d68e14 in bdrv_attach_child_noperm
    (parent_bs=0x5555578ddc80, child_bs=0x555556a7ae40, child_name=0x5555560d0670 "backing", child_class=0x555556402ba0 <child_of_bds>, child_role=8, child=0x5555578e1cd0, tran=0x555557363dd0, errp=0x7fffffffd758) at ../block.c:3103
#3  0x0000555555d6df42 in bdrv_append (bs_new=0x5555578ddc80, bs_top=0x555556a7ae40, errp=0x7fffffffd758) at ../block.c:5336
#4  0x0000555555d57fde in external_snapshot_prepare (common=0x5555573287d0, errp=0x7fffffffd758) at ../blockdev.c:1568
#5  0x0000555555d5985b in qmp_transaction (dev_list=0x7fffffffd7d0, has_props=false, props=0x5555571581c0, errp=0x7fffffffd928) at ../blockdev.c:2358
#6  0x0000555555d56c56 in blockdev_do_action (action=0x7fffffffd850, errp=0x7fffffffd928) at ../blockdev.c:1042
#7  0x0000555555d56d72 in qmp_blockdev_snapshot_sync
    (has_device=false, device=0x0, has_node_name=true, node_name=0x5555572b1b90 "drive01", snapshot_file=0x5555571580f0 "/tmp/overlay01.qcow2", has_snapshot_node_name=true, snapshot_node_name=0x555557158230 "over01", has_format=false, format=0x0, has_mode=false, mode=NEW_IMAGE_MODE_EXISTING, errp=0x7fffffffd928) at ../blockdev.c:1070
#8  0x0000555555e69455 in qmp_marshal_blockdev_snapshot_sync (args=0x7fffe0003910, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:280
#9  0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#10 0x0000555555f06dc7 in aio_bh_call (bh=0x55555716a280) at ../util/async.c:150
#11 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#12 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#13 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#14 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#15 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#16 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#17 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#18 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#19 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#20 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd5e8, new_bs=0x5555578ddc80, free_empty_child=false) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd5e8, new_bs=0x5555578ddc80, free_empty_child=false) at ../block.c:2843
#1  0x0000555555d67717 in bdrv_replace_child_tran (childp=0x7fffffffd5e8, new_bs=0x5555578ddc80, tran=0x555557363dd0, free_empty_child=true) at ../block.c:2444
#2  0x0000555555d6da9f in bdrv_replace_node_noperm (from=0x555556a7ae40, to=0x5555578ddc80, auto_skip=true, tran=0x555557363dd0, errp=0x7fffffffd758) at ../block.c:5208
#3  0x0000555555d6df72 in bdrv_append (bs_new=0x5555578ddc80, bs_top=0x555556a7ae40, errp=0x7fffffffd758) at ../block.c:5343
#4  0x0000555555d57fde in external_snapshot_prepare (common=0x5555573287d0, errp=0x7fffffffd758) at ../blockdev.c:1568
#5  0x0000555555d5985b in qmp_transaction (dev_list=0x7fffffffd7d0, has_props=false, props=0x5555571581c0, errp=0x7fffffffd928) at ../blockdev.c:2358
#6  0x0000555555d56c56 in blockdev_do_action (action=0x7fffffffd850, errp=0x7fffffffd928) at ../blockdev.c:1042
#7  0x0000555555d56d72 in qmp_blockdev_snapshot_sync
    (has_device=false, device=0x0, has_node_name=true, node_name=0x5555572b1b90 "drive01", snapshot_file=0x5555571580f0 "/tmp/overlay01.qcow2", has_snapshot_node_name=true, snapshot_node_name=0x555557158230 "over01", has_format=false, format=0x0, has_mode=false, mode=NEW_IMAGE_MODE_EXISTING, errp=0x7fffffffd928) at ../blockdev.c:1070
#8  0x0000555555e69455 in qmp_marshal_blockdev_snapshot_sync (args=0x7fffe0003910, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:280
#9  0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#10 0x0000555555f06dc7 in aio_bh_call (bh=0x55555716a280) at ../util/async.c:150
#11 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#12 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#13 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#14 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#15 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#16 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#17 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#18 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#19 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#20 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47

==================================

(QEMU) block-commit device=over01 job-id=jobA


(qemu) [New Thread 0x7fffeeef2700 (LWP 30327)]
[Thread 0x7fffeeef2700 (LWP 30327) exited]

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd368, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd368, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x5555578ddc80, child_name=0x5555560d0670 "backing", child_class=0x555556402ba0 <child_of_bds>, child_role=20, perm=0, shared_perm=15, opaque=0x5555578d7870, child=0x5555578db8c0, tran=0x555556a835d0, errp=0x7fffffffd770) at ../block.c:3055
#2  0x0000555555d68e14 in bdrv_attach_child_noperm
    (parent_bs=0x5555578d7870, child_bs=0x5555578ddc80, child_name=0x5555560d0670 "backing", child_class=0x555556402ba0 <child_of_bds>, child_role=20, child=0x5555578db8c0, tran=0x555556a835d0, errp=0x7fffffffd770) at ../block.c:3103
#3  0x0000555555d6df42 in bdrv_append (bs_new=0x5555578d7870, bs_top=0x5555578ddc80, errp=0x7fffffffd770) at ../block.c:5336
#4  0x0000555555dae471 in mirror_start_job
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, creation_flags=0, target=0x555556a7ae40, replaces=0x0, speed=0, granularity=65536, buf_size=16777216, backing_mode=MIRROR_LEAVE_BACKING_CHAIN, zero_target=false, on_source_error=BLOCKDEV_ON_ERROR_REPORT, on_target_error=BLOCKDEV_ON_ERROR_REPORT, unmap=true, cb=0x0, opaque=0x0, driver=0x55555640f320 <commit_active_job_driver>, is_none_mode=false, base=0x555556a7ae40, auto_complete=false, filter_node_name=0x0, is_mirror=false, copy_mode=MIRROR_COPY_MODE_BACKGROUND, errp=0x7fffffffd770) at ../block/mirror.c:1655
#5  0x0000555555daed28 in commit_active_start
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, base=0x555556a7ae40, creation_flags=0, speed=0, on_error=BLOCKDEV_ON_ERROR_REPORT, filter_node_name=0x0, cb=0x0, opaque=0x0, auto_complete=false, errp=0x7fffffffd770) at ../block/mirror.c:1905
#6  0x0000555555d5ab04 in qmp_block_commit
    (has_job_id=true, job_id=0x555557617de0 "jobA", device=0x555557158150 "over01", has_base_node=false, base_node=0x0, has_base=false, base=0x0, has_top_node=false, top_node=0x0, has_top=false, top=0x0, has_backing_file=false, backing_file=0x0, has_speed=false, speed=0, has_on_error=false, on_error=BLOCKDEV_ON_ERROR_REPORT, has_filter_node_name=false, filter_node_name=0x0, has_auto_finalize=false, auto_finalize=false, has_auto_dismiss=false, auto_dismiss=false, errp=0x7fffffffd8d8) at ../blockdev.c:2769
#7  0x0000555555e69cdb in qmp_marshal_block_commit (args=0x7fffe00038b0, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:409
#8  0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#9  0x0000555555f06dc7 in aio_bh_call (bh=0x5555570f3740) at ../util/async.c:150
#10 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#11 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#12 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#13 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#14 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#15 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#16 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#17 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#18 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#19 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd498, new_bs=0x5555578d7870, free_empty_child=false) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd498, new_bs=0x5555578d7870, free_empty_child=false) at ../block.c:2843
#1  0x0000555555d67717 in bdrv_replace_child_tran (childp=0x7fffffffd498, new_bs=0x5555578d7870, tran=0x555556a835d0, free_empty_child=true) at ../block.c:2444
#2  0x0000555555d6da9f in bdrv_replace_node_noperm (from=0x5555578ddc80, to=0x5555578d7870, auto_skip=true, tran=0x555556a835d0, errp=0x7fffffffd770) at ../block.c:5208
#3  0x0000555555d6df72 in bdrv_append (bs_new=0x5555578d7870, bs_top=0x5555578ddc80, errp=0x7fffffffd770) at ../block.c:5343
#4  0x0000555555dae471 in mirror_start_job
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, creation_flags=0, target=0x555556a7ae40, replaces=0x0, speed=0, granularity=65536, buf_size=16777216, backing_mode=MIRROR_LEAVE_BACKING_CHAIN, zero_target=false, on_source_error=BLOCKDEV_ON_ERROR_REPORT, on_target_error=BLOCKDEV_ON_ERROR_REPORT, unmap=true, cb=0x0, opaque=0x0, driver=0x55555640f320 <commit_active_job_driver>, is_none_mode=false, base=0x555556a7ae40, auto_complete=false, filter_node_name=0x0, is_mirror=false, copy_mode=MIRROR_COPY_MODE_BACKGROUND, errp=0x7fffffffd770) at ../block/mirror.c:1655
#5  0x0000555555daed28 in commit_active_start
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, base=0x555556a7ae40, creation_flags=0, speed=0, on_error=BLOCKDEV_ON_ERROR_REPORT, filter_node_name=0x0, cb=0x0, opaque=0x0, auto_complete=false, errp=0x7fffffffd770) at ../block/mirror.c:1905
#6  0x0000555555d5ab04 in qmp_block_commit
    (has_job_id=true, job_id=0x555557617de0 "jobA", device=0x555557158150 "over01", has_base_node=false, base_node=0x0, has_base=false, base=0x0, has_top_node=false, top_node=0x0, has_top=false, top=0x0, has_backing_file=false, backing_file=0x0, has_speed=false, speed=0, has_on_error=false, on_error=BLOCKDEV_ON_ERROR_REPORT, has_filter_node_name=false, filter_node_name=0x0, has_auto_finalize=false, auto_finalize=false, has_auto_dismiss=false, auto_dismiss=false, errp=0x7fffffffd8d8) at ../blockdev.c:2769
#7  0x0000555555e69cdb in qmp_marshal_block_commit (args=0x7fffe00038b0, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:409
#8  0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#9  0x0000555555f06dc7 in aio_bh_call (bh=0x5555570f3740) at ../util/async.c:150
#10 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#11 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#12 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#13 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#14 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#15 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#16 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#17 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#18 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#19 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd2d8, new_bs=0x5555578d7870, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd2d8, new_bs=0x5555578d7870, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x5555578d7870, child_name=0x5555560d3340 "main node", child_class=0x555556402c60 <child_job>, child_role=0, perm=1, shared_perm=7, opaque=0x555556f9acd0, child=0x7fffffffd3f8, tran=0x555556a7acb0, errp=0x7fffffffd770) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x5555578d7870, child_name=0x5555560d3340 "main node", child_class=0x555556402c60 <child_job>, child_role=0, perm=1, shared_perm=7, opaque=0x555556f9acd0, errp=0x7fffffffd770)
    at ../block.c:3159
#3  0x0000555555d74f00 in block_job_add_bdrv (job=0x555556f9acd0, name=0x5555560d3340 "main node", bs=0x5555578d7870, perm=1, shared_perm=7, errp=0x7fffffffd770) at ../blockjob.c:238
#4  0x0000555555d7596b in block_job_create
    (job_id=0x555557617de0 "jobA", driver=0x55555640f320 <commit_active_job_driver>, txn=0x0, bs=0x5555578d7870, perm=1, shared_perm=7, speed=0, flags=0, cb=0x0, opaque=0x0, errp=0x7fffffffd770)
    at ../blockjob.c:483
#5  0x0000555555dae4e1 in mirror_start_job
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, creation_flags=0, target=0x555556a7ae40, replaces=0x0, speed=0, granularity=65536, buf_size=16777216, backing_mode=MIRROR_LEAVE_BACKING_CHAIN, zero_target=false, on_source_error=BLOCKDEV_ON_ERROR_REPORT, on_target_error=BLOCKDEV_ON_ERROR_REPORT, unmap=true, cb=0x0, opaque=0x0, driver=0x55555640f320 <commit_active_job_driver>, is_none_mode=false, base=0x555556a7ae40, auto_complete=false, filter_node_name=0x0, is_mirror=false, copy_mode=MIRROR_COPY_MODE_BACKGROUND, errp=0x7fffffffd770) at ../block/mirror.c:1664
#6  0x0000555555daed28 in commit_active_start
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, base=0x555556a7ae40, creation_flags=0, speed=0, on_error=BLOCKDEV_ON_ERROR_REPORT, filter_node_name=0x0, cb=0x0, opaque=0x0, auto_complete=false, errp=0x7fffffffd770) at ../block/mirror.c:1905
#7  0x0000555555d5ab04 in qmp_block_commit
    (has_job_id=true, job_id=0x555557617de0 "jobA", device=0x555557158150 "over01", has_base_node=false, base_node=0x0, has_base=false, base=0x0, has_top_node=false, top_node=0x0, has_top=false, top=0x0, has_backing_file=false, backing_file=0x0, has_speed=false, speed=0, has_on_error=false, on_error=BLOCKDEV_ON_ERROR_REPORT, has_filter_node_name=false, filter_node_name=0x0, has_auto_finalize=false, auto_finalize=false, has_auto_dismiss=false, auto_dismiss=false, errp=0x7fffffffd8d8) at ../blockdev.c:2769
#8  0x0000555555e69cdb in qmp_marshal_block_commit (args=0x7fffe00038b0, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:409
#9  0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#10 0x0000555555f06dc7 in aio_bh_call (bh=0x5555570f3740) at ../util/async.c:150
#11 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#12 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#13 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#14 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#15 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#16 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#17 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#18 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#19 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#20 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd378, new_bs=0x555556a7ae40, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd378, new_bs=0x555556a7ae40, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x555556a7ae40, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=2, shared_perm=7, opaque=0x555557363a80, child=0x7fffffffd498, tran=0x555557534850, errp=0x7fffffffd770) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x555556a7ae40, child_name=0x5555560db1d8 "root", child_class=0x5555564037c0 <child_root>, child_role=20, perm=2, shared_perm=7, opaque=0x555557363a80, errp=0x7fffffffd770)
    at ../block.c:3159
#3  0x0000555555d912af in blk_insert_bs (blk=0x555557363a80, bs=0x555556a7ae40, errp=0x7fffffffd770) at ../block/block-backend.c:907
#4  0x0000555555dae699 in mirror_start_job
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, creation_flags=0, target=0x555556a7ae40, replaces=0x0, speed=0, granularity=65536, buf_size=16777216, backing_mode=MIRROR_LEAVE_BACKING_CHAIN, zero_target=false, on_source_error=BLOCKDEV_ON_ERROR_REPORT, on_target_error=BLOCKDEV_ON_ERROR_REPORT, unmap=true, cb=0x0, opaque=0x0, driver=0x55555640f320 <commit_active_job_driver>, is_none_mode=false, base=0x555556a7ae40, auto_complete=false, filter_node_name=0x0, is_mirror=false, copy_mode=MIRROR_COPY_MODE_BACKGROUND, errp=0x7fffffffd770) at ../block/mirror.c:1724
#5  0x0000555555daed28 in commit_active_start
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, base=0x555556a7ae40, creation_flags=0, speed=0, on_error=BLOCKDEV_ON_ERROR_REPORT, filter_node_name=0x0, cb=0x0, opaque=0x0, auto_complete=false, errp=0x7fffffffd770) at ../block/mirror.c:1905
#6  0x0000555555d5ab04 in qmp_block_commit
    (has_job_id=true, job_id=0x555557617de0 "jobA", device=0x555557158150 "over01", has_base_node=false, base_node=0x0, has_base=false, base=0x0, has_top_node=false, top_node=0x0, has_top=false, top=0x0, has_backing_file=false, backing_file=0x0, has_speed=false, speed=0, has_on_error=false, on_error=BLOCKDEV_ON_ERROR_REPORT, has_filter_node_name=false, filter_node_name=0x0, has_auto_finalize=false, auto_finalize=false, has_auto_dismiss=false, auto_dismiss=false, errp=0x7fffffffd8d8) at ../blockdev.c:2769
#7  0x0000555555e69cdb in qmp_marshal_block_commit (args=0x7fffe00038b0, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:409
#8  0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#9  0x0000555555f06dc7 in aio_bh_call (bh=0x5555570f3740) at ../util/async.c:150
#10 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#11 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#12 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#13 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#14 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#15 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#16 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#17 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#18 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#19 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd358, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd358, new_bs=0x5555578ddc80, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x5555578ddc80, child_name=0x5555560e09f1 "source", child_class=0x555556402c60 <child_job>, child_role=0, perm=0, shared_perm=7, opaque=0x555556f9acd0, child=0x7fffffffd478, tran=0x555556a83990, errp=0x7fffffffd770) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x5555578ddc80, child_name=0x5555560e09f1 "source", child_class=0x555556402c60 <child_job>, child_role=0, perm=0, shared_perm=7, opaque=0x555556f9acd0, errp=0x7fffffffd770)
    at ../block.c:3159
#3  0x0000555555d74f00 in block_job_add_bdrv (job=0x555556f9acd0, name=0x5555560e09f1 "source", bs=0x5555578ddc80, perm=0, shared_perm=7, errp=0x7fffffffd770) at ../blockjob.c:238
#4  0x0000555555dae878 in mirror_start_job
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, creation_flags=0, target=0x555556a7ae40, replaces=0x0, speed=0, granularity=65536, buf_size=16777216, backing_mode=MIRROR_LEAVE_BACKING_CHAIN, zero_target=false, on_source_error=BLOCKDEV_ON_ERROR_REPORT, on_target_error=BLOCKDEV_ON_ERROR_REPORT, unmap=true, cb=0x0, opaque=0x0, driver=0x55555640f320 <commit_active_job_driver>, is_none_mode=false, base=0x555556a7ae40, auto_complete=false, filter_node_name=0x0, is_mirror=false, copy_mode=MIRROR_COPY_MODE_BACKGROUND, errp=0x7fffffffd770) at ../block/mirror.c:1764
#5  0x0000555555daed28 in commit_active_start
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, base=0x555556a7ae40, creation_flags=0, speed=0, on_error=BLOCKDEV_ON_ERROR_REPORT, filter_node_name=0x0, cb=0x0, opaque=0x0, auto_complete=false, errp=0x7fffffffd770) at ../block/mirror.c:1905
#6  0x0000555555d5ab04 in qmp_block_commit
    (has_job_id=true, job_id=0x555557617de0 "jobA", device=0x555557158150 "over01", has_base_node=false, base_node=0x0, has_base=false, base=0x0, has_top_node=false, top_node=0x0, has_top=false, top=0x0, has_backing_file=false, backing_file=0x0, has_speed=false, speed=0, has_on_error=false, on_error=BLOCKDEV_ON_ERROR_REPORT, has_filter_node_name=false, filter_node_name=0x0, has_auto_finalize=false, auto_finalize=false, has_auto_dismiss=false, auto_dismiss=false, errp=0x7fffffffd8d8) at ../blockdev.c:2769
#7  0x0000555555e69cdb in qmp_marshal_block_commit (args=0x7fffe00038b0, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:409
#8  0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#9  0x0000555555f06dc7 in aio_bh_call (bh=0x5555570f3740) at ../util/async.c:150
#10 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#11 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#12 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#13 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#14 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#15 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#16 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#17 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#18 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#19 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd358, new_bs=0x555556a7ae40, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd358, new_bs=0x555556a7ae40, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68bcb in bdrv_attach_child_common
    (child_bs=0x555556a7ae40, child_name=0x5555560e09f8 "target", child_class=0x555556402c60 <child_job>, child_role=0, perm=0, shared_perm=15, opaque=0x555556f9acd0, child=0x7fffffffd478, tran=0x555556f115b0, errp=0x5555567dcc58 <error_abort>) at ../block.c:3055
#2  0x0000555555d68f74 in bdrv_root_attach_child
    (child_bs=0x555556a7ae40, child_name=0x5555560e09f8 "target", child_class=0x555556402c60 <child_job>, child_role=0, perm=0, shared_perm=15, opaque=0x555556f9acd0, errp=0x5555567dcc58 <error_abort>) at ../block.c:3159
#3  0x0000555555d74f00 in block_job_add_bdrv (job=0x555556f9acd0, name=0x5555560e09f8 "target", bs=0x555556a7ae40, perm=0, shared_perm=15, errp=0x5555567dcc58 <error_abort>) at ../blockjob.c:238
#4  0x0000555555dae8b1 in mirror_start_job
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, creation_flags=0, target=0x555556a7ae40, replaces=0x0, speed=0, granularity=65536, buf_size=16777216, backing_mode=MIRROR_LEAVE_BACKING_CHAIN, zero_target=false, on_source_error=BLOCKDEV_ON_ERROR_REPORT, on_target_error=BLOCKDEV_ON_ERROR_REPORT, unmap=true, cb=0x0, opaque=0x0, driver=0x55555640f320 <commit_active_job_driver>, is_none_mode=false, base=0x555556a7ae40, auto_complete=false, filter_node_name=0x0, is_mirror=false, copy_mode=MIRROR_COPY_MODE_BACKGROUND, errp=0x7fffffffd770) at ../block/mirror.c:1773
#5  0x0000555555daed28 in commit_active_start
    (job_id=0x555557617de0 "jobA", bs=0x5555578ddc80, base=0x555556a7ae40, creation_flags=0, speed=0, on_error=BLOCKDEV_ON_ERROR_REPORT, filter_node_name=0x0, cb=0x0, opaque=0x0, auto_complete=false, errp=0x7fffffffd770) at ../block/mirror.c:1905
#6  0x0000555555d5ab04 in qmp_block_commit
    (has_job_id=true, job_id=0x555557617de0 "jobA", device=0x555557158150 "over01", has_base_node=false, base_node=0x0, has_base=false, base=0x0, has_top_node=false, top_node=0x0, has_top=false, top=0x0, has_backing_file=false, backing_file=0x0, has_speed=false, speed=0, has_on_error=false, on_error=BLOCKDEV_ON_ERROR_REPORT, has_filter_node_name=false, filter_node_name=0x0, has_auto_finalize=false, auto_finalize=false, has_auto_dismiss=false, auto_dismiss=false, errp=0x7fffffffd8d8) at ../blockdev.c:2769
#7  0x0000555555e69cdb in qmp_marshal_block_commit (args=0x7fffe00038b0, ret=0x7ffff7fcbd98, errp=0x7ffff7fcbd90) at qapi/qapi-commands-block-core.c:409
#8  0x0000555555ee14f6 in do_qmp_dispatch_bh (opaque=0x7ffff7fcbe30) at ../qapi/qmp-dispatch.c:128
#9  0x0000555555f06dc7 in aio_bh_call (bh=0x5555570f3740) at ../util/async.c:150
#10 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#11 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#12 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#13 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#14 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#15 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#16 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#17 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#18 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#19 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47

==================================

(QEMU) block-job-complete device=jobA

(qemu) 
Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd7b8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd7b8, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7fffffffd7b8) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555556fd12e0) at ../block.c:3230
#3  0x0000555555d91217 in blk_remove_bs (blk=0x555557363a80) at ../block/block-backend.c:896
#4  0x0000555555d9038b in blk_delete (blk=0x555557363a80) at ../block/block-backend.c:480
#5  0x0000555555d906ab in blk_unref (blk=0x555557363a80) at ../block/block-backend.c:538
#6  0x0000555555dac03a in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:687
#7  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#8  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#9  0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#10 0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#11 0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#12 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#13 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#14 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#15 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#16 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#17 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#18 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#19 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#20 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#21 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#22 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#23 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#24 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.
[Thread 0x7ffd2bc83700 (LWP 30360) exited]
[Thread 0x7fffeeef2700 (LWP 30358) exited]
[Thread 0x7ffd2b482700 (LWP 30361) exited]

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd798, new_bs=0x555556a7ae40, free_empty_child=false) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd798, new_bs=0x555556a7ae40, free_empty_child=false) at ../block.c:2843
#1  0x0000555555d67717 in bdrv_replace_child_tran (childp=0x7fffffffd798, new_bs=0x555556a7ae40, tran=0x555556fd12c0, free_empty_child=true) at ../block.c:2444
#2  0x0000555555d6da9f in bdrv_replace_node_noperm (from=0x5555578ddc80, to=0x555556a7ae40, auto_skip=true, tran=0x555556fd12c0, errp=0x7fffffffd878) at ../block.c:5208
#3  0x0000555555d6dcc7 in bdrv_replace_node_common (from=0x5555578ddc80, to=0x555556a7ae40, auto_skip=true, detach_subchain=false, errp=0x7fffffffd878) at ../block.c:5265
#4  0x0000555555d6de22 in bdrv_replace_node (from=0x5555578ddc80, to=0x555556a7ae40, errp=0x7fffffffd878) at ../block.c:5303
#5  0x0000555555dac2ce in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:743
#6  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#7  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#8  0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#9  0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#10 0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#11 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#12 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#13 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#14 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#15 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#16 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#17 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#18 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#19 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#20 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#21 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#22 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#23 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd808, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd808, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7fffffffd808) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555556f115d0) at ../block.c:3230
#3  0x0000555555d74d94 in block_job_remove_all_bdrv (job=0x555556f9acd0) at ../blockjob.c:203
#4  0x0000555555dac3da in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:772
#5  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#6  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#7  0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#8  0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#9  0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#10 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#11 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#12 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#13 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#14 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#15 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#16 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#17 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#18 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#19 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#20 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#21 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#22 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd808, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd808, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7fffffffd808) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557b30200) at ../block.c:3230
#3  0x0000555555d74d94 in block_job_remove_all_bdrv (job=0x555556f9acd0) at ../blockjob.c:203
#4  0x0000555555dac3da in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:772
#5  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#6  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#7  0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#8  0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#9  0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#10 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#11 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#12 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#13 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#14 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#15 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#16 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#17 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#18 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#19 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#20 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#21 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#22 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd808, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd808, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7fffffffd808) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557593450) at ../block.c:3230
#3  0x0000555555d74d94 in block_job_remove_all_bdrv (job=0x555556f9acd0) at ../blockjob.c:203
#4  0x0000555555dac3da in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:772
#5  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#6  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#7  0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#8  0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#9  0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#10 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#11 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#12 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#13 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#14 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#15 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#16 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#17 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#18 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#19 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#20 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#21 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#22 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd798, new_bs=0x555556a7ae40, free_empty_child=false) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd798, new_bs=0x555556a7ae40, free_empty_child=false) at ../block.c:2843
#1  0x0000555555d67717 in bdrv_replace_child_tran (childp=0x7fffffffd798, new_bs=0x555556a7ae40, tran=0x555557534870, free_empty_child=true) at ../block.c:2444
#2  0x0000555555d6da9f in bdrv_replace_node_noperm (from=0x5555578d7870, to=0x555556a7ae40, auto_skip=true, tran=0x555557534870, errp=0x5555567dcc58 <error_abort>) at ../block.c:5208
#3  0x0000555555d6dcc7 in bdrv_replace_node_common (from=0x5555578d7870, to=0x555556a7ae40, auto_skip=true, detach_subchain=false, errp=0x5555567dcc58 <error_abort>) at ../block.c:5265
#4  0x0000555555d6de22 in bdrv_replace_node (from=0x5555578d7870, to=0x555556a7ae40, errp=0x5555567dcc58 <error_abort>) at ../block.c:5303
#5  0x0000555555dac3fe in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:773
#6  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#7  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#8  0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#9  0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#10 0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#11 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#12 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#13 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#14 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#15 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#16 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#17 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#18 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#19 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#20 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#21 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#22 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#23 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd768, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd768, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7fffffffd768) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555556854a90) at ../block.c:3230
#3  0x0000555555d6935f in bdrv_unref_child (parent=0x5555578d7870, child=0x555556854a90) at ../block.c:3309
#4  0x0000555555d6d2f6 in bdrv_close (bs=0x5555578d7870) at ../block.c:4940
#5  0x0000555555d6e32a in bdrv_delete (bs=0x5555578d7870) at ../block.c:5404
#6  0x0000555555d71187 in bdrv_unref (bs=0x5555578d7870) at ../block.c:6919
#7  0x0000555555dac438 in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:780
#8  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#9  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#10 0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#11 0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#12 0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#13 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#14 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#15 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#16 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#17 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#18 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#19 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#20 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#21 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#22 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#23 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#24 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#25 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd768, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd768, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7fffffffd768) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x555557347940) at ../block.c:3230
#3  0x0000555555d6935f in bdrv_unref_child (parent=0x5555578ddc80, child=0x555557347940) at ../block.c:3309
#4  0x0000555555d6d2f6 in bdrv_close (bs=0x5555578ddc80) at ../block.c:4940
#5  0x0000555555d6e32a in bdrv_delete (bs=0x5555578ddc80) at ../block.c:5404
#6  0x0000555555d71187 in bdrv_unref (bs=0x5555578ddc80) at ../block.c:6919
#7  0x0000555555dac444 in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:781
#8  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#9  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#10 0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#11 0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#12 0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#13 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#14 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#15 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#16 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#17 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#18 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#19 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#20 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#21 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#22 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#23 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#24 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#25 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
(gdb) c
Continuing.

Thread 1 "qemu-system-x86" hit Breakpoint 1, bdrv_replace_child_noperm (childp=0x7fffffffd768, new_bs=0x0, free_empty_child=true) at ../block.c:2843
2843	    BdrvChild *child = *childp;
(gdb) bt
#0  bdrv_replace_child_noperm (childp=0x7fffffffd768, new_bs=0x0, free_empty_child=true) at ../block.c:2843
#1  0x0000555555d68e99 in bdrv_detach_child (childp=0x7fffffffd768) at ../block.c:3118
#2  0x0000555555d69182 in bdrv_root_unref_child (child=0x5555575c8f40) at ../block.c:3230
#3  0x0000555555d6935f in bdrv_unref_child (parent=0x5555578ddc80, child=0x5555575c8f40) at ../block.c:3309
#4  0x0000555555d6d2f6 in bdrv_close (bs=0x5555578ddc80) at ../block.c:4940
#5  0x0000555555d6e32a in bdrv_delete (bs=0x5555578ddc80) at ../block.c:5404
#6  0x0000555555d71187 in bdrv_unref (bs=0x5555578ddc80) at ../block.c:6919
#7  0x0000555555dac444 in mirror_exit_common (job=0x555556f9acd0) at ../block/mirror.c:781
#8  0x0000555555dac475 in mirror_prepare (job=0x555556f9acd0) at ../block/mirror.c:788
#9  0x0000555555d77c6a in job_prepare (job=0x555556f9acd0) at ../job.c:837
#10 0x0000555555d762fd in job_txn_apply (job=0x555556f9acd0, fn=0x555555d77c02 <job_prepare>) at ../job.c:158
#11 0x0000555555d77cf9 in job_do_finalize (job=0x555556f9acd0) at ../job.c:854
#12 0x0000555555d77ec3 in job_completed_txn_success (job=0x555556f9acd0) at ../job.c:908
#13 0x0000555555d77f66 in job_completed (job=0x555556f9acd0) at ../job.c:921
#14 0x0000555555d77fb9 in job_exit (opaque=0x555556f9acd0) at ../job.c:941
#15 0x0000555555f06dc7 in aio_bh_call (bh=0x55555715bfc0) at ../util/async.c:150
#16 0x0000555555f06ed1 in aio_bh_poll (ctx=0x555556852d20) at ../util/async.c:178
#17 0x0000555555eee166 in aio_dispatch (ctx=0x555556852d20) at ../util/aio-posix.c:421
#18 0x0000555555f07302 in aio_ctx_dispatch (source=0x555556852d20, callback=0x0, user_data=0x0) at ../util/async.c:320
#19 0x00007ffff6c40119 in g_main_context_dispatch () at /lib64/libglib-2.0.so.0
#20 0x0000555555f1900b in glib_pollfds_poll () at ../util/main-loop.c:297
#21 0x0000555555f19085 in os_host_main_loop_wait (timeout=0) at ../util/main-loop.c:320
#22 0x0000555555f1918a in main_loop_wait (nonblocking=0) at ../util/main-loop.c:596
#23 0x0000555555a7b2ee in qemu_main_loop () at ../softmmu/runstate.c:734
#24 0x00005555558210f2 in qemu_main (argc=30, argv=0x7fffffffdd98, envp=0x0) at ../softmmu/main.c:38
#25 0x0000555555821124 in main (argc=30, argv=0x7fffffffdd98) at ../softmmu/main.c:47
